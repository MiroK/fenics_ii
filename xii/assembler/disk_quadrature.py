import numpy as np

def disk_quadrature(degree):
    '''
    Symmetric quadrature formulas over a unit disk

    Kim, K., & Song, M. (1997). Symmetric quadrature formulas over a unit disk. 
    Korean Journal of Computational & Applied Mathematics, 4, 179-192.
    '''
    if degree % 2 == 0:
        degree += 1
        print(f'REQUESTED EVEN DEGREE {degree-1}. ADJUSTING TO ODD {degree}')                
    if degree > 19:
        print('EXCEEDING MAXIMUM SUPPORTED DEGREE. FALLING BACK TO 19')
        degree == 19

    # Templates for weight
    if degree == 1:
        data = [(3.141592653589793, 0.000000000000000, 0.000000000000000, 1)]
    elif degree == 3:
        data = [(0.785398163397448, 0.707106781186548, 0.000000000000000, 2)]
    elif degree == 5:
        data = [(0.732786462492640, 0.650115167343736, 0.000000000000000, 2),
                (0.052611700904808, 0.888073833977115, 0.888073833977115, 3)]
    elif degree == 7:
        data = [(0.232710566932577, 0.866025403784439, 0.000000000000000, 2),
                (0.387077796006226, 0.322914992067400, 0.322914992067400, 3),
                (0.165609800458645, 0.644171310389465, 0.644171310389465, 3)]
    elif degree == 9:
        data = [(0.071488826617391, 0.952458896434417, 0.000000000000000, 2),
                (0.327176874928167, 0.415187657878755, 0.000000000000000, 2),
                (0.005591341512851, 0.834794942216211, 0.834794942216211, 3),
                (0.190570560169519, 0.740334457173511, 0.379016937530835, 4)]
    elif degree == 11:
        data = [(-0.103220620849181, 0.000000000000000, 0.000000000000000, 1),
                (0.000561120485457, 10.081713912649978, 10.081713912649978, 3),
                (0.234185472691706, 0.329855087221954, 0.329855087221954, 3),
                (0.123731369524117, 0.163309595229403, 0.163309595229403, 3),
                (0.194337435615691, 0.582963679648472, 0.582963679648472, 3),
                (0.129193960146342, 0.862551409331466, 0.191706749096887, 4)]
    elif degree == 13:
        data = [(0.156239869837333, 0.283402832348825, 0.000000000000000, 2),
                (0.069447409266977, 0.920575474036251, 0.000000000000000, 2),
                (0.138145910534871, 0.649007230578002, 0.000000000000000, 2),
                (0.043376583887155, 0.677355106028069, 0.677355106028069, 3),
                (0.150228334140010, 0.412672216763289, 0.412672216763289, 3),
                (0.018199321926118, 0.938694583835123, 0.335767600829539, 4),
                (0.095780705939433, 0.752042776803954, 0.379717011170077, 4)]
    elif degree == 15:
        data = [(0.125290208564338, 0.252863797091293, 0.000000000000000, 2),
                (0.016712625496982, 0.989746802511614, 0.000000000000000, 2),
                (0.109500391126365, 0.577728928444958, 0.000000000000000, 2),
                (0.066237455796397, 0.873836956645035, 0.000000000000000, 2),
                (0.026102860184358, 0.689299380791136, 0.689299380791136, 3),
                (0.066000934661100, 0.597614304667208, 0.597614304667208, 3),
                (0.127428372681720, 0.375416824626170, 0.375416824626170, 3),
                (0.042523065826681, 0.883097111318591, 0.365790800400663, 4),
                (0.081539591616413, 0.707438744960070, 0.293030722710664, 4)]
    elif degree == 17:
        data = [(0.034218732123473, 0.000061843487605, 0.000000000000000, 2),
                (0.016529016194279, 0.980790725733799, 0.000000000000000, 2),
                (0.128441621643862, 0.536380801743208, 0.000000000000000, 2),
                (0.057523498415081, 0.859692027602019, 0.000000000000000, 2),
                (0.000019445945395, 0.890507932479849, 0.890507932479849, 3),
                (0.029882788585530, 0.597728327225623, 0.597728327225623, 3),
                (0.086625257876566, 0.472638508474430, 0.472638508474430, 3),
                (0.135289763196368, 0.256583368615187, 0.256583368615187, 3),
                (0.030442743336826, 0.915666628257231, 0.290750921163427, 4),
                (0.036355668706617, 0.775130682141990, 0.550400039905684, 4),
                (0.081635607665003, 0.722293685844502, 0.274942296086914, 4)]
    elif degree == 19:
        data = [(-0.336959088794964, 0.860125674956782, 0.000000000000000, 2),
                (-0.252102704609804, 0.860125119919931, 0.000000000000000, 2),
                (0.131164048626801, 0.547071550894734, 0.000000000000000, 2),
                (-0.010919895825604, 0.927565701076356, 0.927565701076356, 3),
                (0.010744805554708, 0.928162274936277, 0.928162274936277, 3),
                (0.004798012482265, 0.755935467576794, 0.755935467576794, 3),
                (0.072711702889623, 0.618205357502056, 0.618205357502056, 3),
                (0.115883691032049, 0.398705530364909, 0.398705530364909, 3),
                (0.123519504105529, 0.175541035301314, 0.175541035301314, 3),
                (0.022426281825809, 0.959568314399471, 0.155454100986327, 4),
                (0.033906878046312, 0.851375493057155, 0.435023471372536, 4),
                (0.332072154179621, 0.858667011279674, 0.030948726948493, 4),
                (0.074873729916680, 0.711569636216547, 0.300178547400372, 4)]
    else:
        raise ValueError

    # Compute from template
    xqs, wqs = [], []
    for row in data:
        weight, x, y, t = row
        # I t1 ω1 (0, 0)
        if t == 1:
            xqs.append([x, y])
            wqs.append(weight)
            # II t2 ω2,i (±xi, 0), (0, ±xi)            
        elif t == 2:
            assert abs(y) < 1E-10
            for (xq, yq) in ((x, 0), (-x, 0), (0, x), (0, -x)):
                xqs.append([xq, yq])
                wqs.append(weight)
        # III t3 ω3,i (±xi, ±xi)
        elif t == 3:
            assert abs(x-y) < 1E-10
            for (xq, yq) in ((x, x), (x, -x), (-x, x), (-x, -x)):
                xqs.append([xq, yq])
                wqs.append(weight)        
        # IV t4 ω4,i (±xi, ±yi), (±yi, ±xi)            
        elif t == 4:
            for (xq, yq) in ((x, y), (x, -y), (-x, y), (-x, -y), (y, x), (y, -x), (-y, x), (-y, -x)):
                xqs.append([xq, yq])
                wqs.append(weight)
    xqs, wqs = np.array(xqs), np.array(wqs)
    return xqs, wqs
